/*! postmate 2015-09-07 */
myApp.controller("AdminController",["$scope","$http",function(a,b){a.map={center:{latitude:44.9778,longitude:-93.265},zoom:12,options:{panControl:!1,zoomControl:!1,scaleControl:!1,mapTypeControl:!1,draggable:!1,scrollwheel:!1,streetViewControl:!1}},a.getPostmatesDeliveries=function(){a.markers=[],b.get("/postmates/deliveries").then(function(b){console.log("received delivery data",b.data),a.delivery=b.data,angular.forEach(b.data.data,function(b,c){null!=b.courier&&a.markers.push({id:c,coords:{latitude:b.courier.location.lat,longitude:b.courier.location.lng}})})})},a.getPostmatesDeliveries(),a.postmatesExampleOrder=function(){var c;b.post("/postmates/query",{dropoff_address:"1750 Hennepin Ave Minneapolis, MN 55401"}).then(function(d){c=d.data,c.dropoff_phone_number="123-456-7890",c.dropoff_name="demo",c.dropoff_notes="demo",b.post("/postmates/create",c).then(function(b){a.getData(),console.log(b.data)})})},a.createProduct=function(){null!=a.categoryId&&void 0!=a.url_slug&&void 0!=a.price&&b.post("/product/create",{category:a.categoryId,desc:a.description,price:a.price,name:a.name,img_src:a.img_src,url_slug:a.url_slug}).then(function(b){console.log(b),a.getData()})},a.deleteProduct=function(c,d){b.post("/product/delete",{categoryId:c,productId:d}).then(function(b){a.getData(),console.log(b)})},a.createCategory=function(c,d){null==c?console.log("no category name"):null==d?console.log("no url slug"):b.post("/category/create",{name:c,url:d}).then(function(b){void 0==b.data.errmsg?a.categories.push(b.data):console.log(b.data.errmsg)})},a.deleteCategory=function(c){b.post("/category/delete",{categoryId:c}).then(function(b){a.getData(),console.log(b)})}}]),myApp.controller("CategoryController",["$scope","$routeParams","$location",function(a,b,c){a.category=b.category,angular.forEach(a.categories,function(b){b.url==a.category&&(a.products=b.products)}),a.categoryClick=function(a,b){console.log(a,b),c.path("/"+a+"/"+b)}}]),myApp.controller("ProductController",["$scope","$routeParams",function(a,b){a.product=b.product,a.category=b.category,angular.forEach(a.categories,function(c){c.url==b.category&&angular.forEach(c.products,function(c){c.url_slug==b.product&&(a.productData=c)})})}]),myApp.controller("QuoteController",["$scope","$http",function(a,b){a.getQuote=function(){b.post("/postmates/query",{dropoff_address:a.delivery.destination}).then(function(b){a.order=b.data,a.quote=a.order.quoteObject,a.quote.fee/=100})},a.sendOrder=function(c,d,e,f,g){c.dropoff_phone_number=e,c.dropoff_name=d,c.dropoff_business_name=g,c.dropof_notes=f,b.post("/postmates/create",c).then(function(b){a.orderDetails=b.data,console.log(b.data)})}}]),myApp.controller("LoginController",["$location","$scope","$http","Auth",function(a,b,c,d){b.login=function(b,e){c.post("/login",{username:b,password:e}).then(function(b){d.setUser(b.data),a.path("/user")})},b.register=function(b,e){c.post("/register",{username:b,password:e}).then(function(b){d.setUser(b.data),a.path("/user")})}}]),myApp.controller("UserController",["$scope","$http","Auth","$location",function(a,b,c,d){console.log(a.user),a.user?(a.map={center:{latitude:44.9778,longitude:-93.265},zoom:12,options:{panControl:!1,zoomControl:!1,scaleControl:!1,mapTypeControl:!1,draggable:!1,scrollwheel:!1,streetViewControl:!1}},a.markers=[],angular.forEach(a.user.orders,function(c,d){console.log(c.deliveryObject),c.deliveryObject.complete||(b.post("/postmates/update",c),function(a,b){console.log(b)},c.deliveryObject.courier&&a.markers.push({id:d,coords:{latitude:c.deliveryObject.delivery.courier.location.lat,longitude:c.deliveryObject.delivery.courier.location.lng}}))})):d.path("/")}]);