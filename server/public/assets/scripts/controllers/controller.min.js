/*! postmate 2015-09-02 */
myApp.controller("CategoryController",["$scope","$routeParams","$http",function(a,b,c){a.category=b.category,angular.forEach(a.categories,function(b){b.url==a.category&&(a.products=b.products)})}]),myApp.controller("ProductController",["$scope","$routeParams","$http",function(a,b,c){a.product=b.product,a.category=b.category,angular.forEach(a.categories,function(c){c.url==b.category&&angular.forEach(c.products,function(c){c.url_slug==b.product&&(a.productData=c)})})}]),myApp.controller("QuoteController",["$scope","$http",function(a,b){a.getQuote=function(){b.post("/postmates/query",{dropoff_address:a.delivery.destination}).then(function(b){console.log(b.data),a.quote=b.data,a.quote.fee/=100})},a.sendOrder=function(c){b.post("/postmates/create",{quote:c,dropoff_address:a.delivery.destination,dropoff_phone_number:a.delivery.phone_number,dropoff_name:a.delivery.dropoff_name,dropoff_business_name:a.dropoff_business_name,dropoff_notes:a.dropoff_notes}).then(function(b){a.orderDetails=b.data,console.log(b.data)})}}]),myApp.controller("UserController",["$scope","$http",function(a,b){b.get("/user").then(function(b){a.username=b.data})}]),myApp.controller("AdminController",["$scope","$http","uiGmapGoogleMapApi",function(a,b,c){a.getPostmatesDeliveries=function(){a.markers=[],b.get("/postmates/deliveries").then(function(b){console.log("received delivery data",b.data),a.delivery=b.data,angular.forEach(b.data.data,function(b,c){null!=b.courier&&a.markers.push({id:c,coords:{latitude:b.courier.location.lat,longitude:b.courier.location.lng}})})})},a.postmatesExampleOrder=function(){b.post("/postmates/query",{dropoff_address:"1750 Hennepin Ave Minneapolis, MN 55403"}).then(function(c){console.log(c.data),b.post("/postmates/create",{quote:c.data,dropoff_address:"1750 Hennepin Ave Minneapolis, MN 55403",dropoff_phone_number:"123-456-7890",dropoff_name:"demo",dropoff_notes:"demo"}).then(function(b){a.getData(),console.log(b.data)})})},a.getPostmatesDeliveries(),a.map={center:{latitude:44.9778,longitude:-93.265},zoom:12},a.markers=[],c.then(function(a){console.log(a)}),a.selectCategory=function(b){a.categoryId=b._id},a.createProduct=function(){null!=a.categoryId&&b.post("/product/create",{category:a.categoryId,desc:a.description,price:a.price,name:a.name,img_src:a.img_src,url_slug:a.url_slug}).then(function(){a.getData()})},a.createCategory=function(){b.post("/category/create",{name:a.newCategory,url:a.urlSlug,description:a.newDescription}).then(function(b){console.log(b),a.categories.push(b.data)})},a.deleteCategory=function(c){b.post("/category/delete",{categoryId:c}).then(function(b){a.getData(),console.log(b)})}}]);